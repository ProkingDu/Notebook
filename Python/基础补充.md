
## 词法分析

### 行结构

**逻辑行**：

**Python源代码文件被词法分析器解析后生成的形符流的每一行。**

NEWLINE 形符表示结束逻辑行。语句不能超出逻辑行的边界，除非句法支持 NEWLINE （例如，复合语句中的多行子语句）。根据显式或隐式 行拼接 规则，一个或多个 物理行 可组成逻辑行。


**物理行**：

> 物理行是一序列字符，由行尾序列终止。源文件和字符串可使用任意标准平台行终止序列 - Unix ASCII 字符 LF （换行）、 Windows ASCII 字符序列 CR LF （回车换行）、或老式 Macintosh ASCII 字符 CR （回车）。不管在哪个平台，这些形式均可等价使用。输入结束也可以用作最终物理行的隐式终止符。

实际上就是源代码文件中的每一行。

一般来说，为了代码更加可读和提高词法分析器的效率，建议一个物理行只对应一个逻辑行。

通俗来说，物理行就是在源代码中编写的代码所在的行数，逻辑行即词法分析器处理预编译后所在的那一行。

如果需要在一个物理行编写多个逻辑行，通过分号把语句分割开，例如：
```py
a=1;print(a)
```
等同于：
```py
a=1;print(a);
```

如果将一个逻辑行拆分为多个物理行，使用反斜杠连接：
```
a=0
b=a\
if\
a>0\
else\
-1;
```

等同于：
```py
a=0
b=a if a>0 else -1
```

### 编码声明

Python 脚本第一或第二行的注释匹配正则表达式 `coding[=:]\s*([-\w.]+) `时，该注释会被当作编码声明；这个表达式的第一组指定了源码文件的编码。编码声明必须独占一行，在第二行时，则第一行必须也是注释。编码表达式的形式如下：

`# -*- coding: <encoding-name> -*-`

同时也支持如下格式：

`# vim:fileencoding=<encoding-name>`

示例：
设定编码为GBK2312
`# -- coding: GBK2312 --`
或者
`# vim:fileencoding=GBK2312`

 没有编码声明时，默认编码为 UTF-8。此外，如果文件的首字节为 UTF-8 字节顺序标志（`b'\xef\xbb\xbf'`），文件编码也声明为 UTF-8（这是 Microsoft 的 **notepad** 等软件支持的形式）。

### 关键字

在python3.10版本之后加入了软关键字，`例如match`、`type`、`_`、`case`等被作为软关键字，他们只有在特定的上下文下才被作为保留关键字。

其中`type`是在3.12版本之后加入的。

即使是软关键字，也不建议作为普通标志符使用。


